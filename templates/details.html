{% extends "template.html" %}
{% block body %}
  <h1> Device <i>{{ alias|safe }}</i></h1> 
  {% if mac != alias %}
  (unique id <i>{{ mac }}</i>)
  {% endif %}  
  {% set last_time, last_date = tdformat(last_time) %}
  <h2>Current temperature: <b>{{ tempformat(last_temp) }}</b></h2>
  <h2>Last recorded: <b>{{ last_time }}, {{ last_date }}</b></h2>
    <form action="{{ url_for('set_alias', mac=mac) }}" method="post" class="set-alias">
      <dl>
        <dt>Change alias for <i>{{ alias|safe }}</i>:
        <dd><input type="text" size="30" name="new_alias" value="{{ alias|safe }}">
        <dd><input type="submit" value="Confirm">
      </dl>
    </form>
    <div id="temp-graph"></div>
    <h2>Last {{ data|length }} hourly readings:</h2>
    <table class="hist-table">
      {% for td, temp in data %}
      {% set time, date = tdformat(td) %}
      <tr><td>{{ date }}</td> <td>{{ time }}</td> <td>{{ tempformat(temp) }}</td></tr>
      {% endfor %}
    </table>
    <a href={{ url_for('history', mac=mac, count=50, offset=0) }}>Show more history</a><br>
    <a href={{ url_for('index') }}>Return to device list</a>
{% endblock %}
{% block foot %}
<!-- Plotly.js -->
<script src={{ url_for('static', filename='js/plotly-latest.min.js') }}></script>
<script type="text/javascript">
  var myDiv = document.getElementById('temp-graph');
  var graph = {{graph | safe}};
  Plotly.plot("temp-graph", graph.data, graph.layout || {});
</script>
{% endblock %}
